<mat-card class="mat-elevation-z5 border card">
  <mat-card-title class="mb-2">Add/Update Book</mat-card-title>
  <div class="form-div">
    <form
      [formGroup]="form"
      #formDirective="ngForm"
      *ngIf="form && authors$"
      (ngSubmit)="addBookHandler()"
    >
      <mat-form-field class="margin" appearance="legacy">
        <mat-label>Title</mat-label>
        <input
          type="text"
          matInput
          formControlName="titleFormControl"
          placeholder="Book Title"
          [ngModel]="(bookActive$ | async)?.title"
          required
        />
        <mat-error *ngIf="form.get('titleFormControl').invalid">
          Title is <strong>required</strong>
        </mat-error>
      </mat-form-field>

      <mat-form-field class="margin" appearance="legacy">
        <mat-label>Author</mat-label>
        <mat-select
          formControlName="authorFormControl"
          required
          [ngModel]="(bookActive$ | async)?.author"
        >
          <mat-option *ngFor="let author of authors$ | async" [value]="author">
            <span>{{ author.givenName }} {{ author.surName }}</span>
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field class="margin" appearance="legacy">
        <mat-label>ISBN</mat-label>
        <input
          type="text"
          matInput
          formControlName="ISBNFormControl"
          placeholder="ISBN"
          [ngModel]="(bookActive$ | async)?.ISBN"
          required
        />
        <mat-error *ngIf="form.get('ISBNFormControl').invalid">
          ISBN is <strong>required</strong>
        </mat-error>
      </mat-form-field>

      <mat-form-field class="margin" appearance="legacy">
        <mat-label>Publisher</mat-label>
        <input
          type="text"
          matInput
          formControlName="publisherFormControl"
          placeholder="Publisher"
          [ngModel]="(bookActive$ | async)?.publisher"
        />
      </mat-form-field>

      <mat-form-field class="margin" appearance="legacy">
        <mat-label>Edition</mat-label>
        <input
          type="text"
          matInput
          formControlName="editionFormControl"
          placeholder="Edition"
          [ngModel]="(bookActive$ | async)?.edition"
        />
      </mat-form-field>

      <mat-form-field class="margin" appearance="legacy">
        <mat-label>Publishing Date</mat-label>
        <input
          type="text"
          matInput
          formControlName="publishingDateFormControl"
          placeholder="Publishing Date"
          [ngModel]="(bookActive$ | async)?.publishingDate"
        />
      </mat-form-field>

      <ng-container
        *ngFor="
          let formChapters of chapterFormArray?.controls;
          let i = index;
        "
      >
        <mat-form-field class="margin" appearance="legacy">
          <mat-label>Chapter title</mat-label>
          <input
            type="text"
            matInput
            formControlName="formChapters"
            placeholder="Publishing Date"
            required=""
          />
          <mat-error *ngIf="form.get('formChapters').invalid">
            A chapter title is <strong>required</strong>
          </mat-error>
        </mat-form-field>
      </ng-container>

      <div class="actionButtons">
        <button
          class="m-2"
          mat-raised-button
          color="primary"
          type="submit"
          [disabled]="!form.valid"
        >
          SAVE
        </button>
        <button
          class="m-2"
          mat-raised-button
          color="primary"
          type="button"
          (click)="addChapter()"
        >
          ADD CHAPTER
        </button>
        <button
          class="m-2"
          mat-raised-button
          color="primary"
          type="button"
          (click)="resetHandler(formDirective)"
        >
          RESET
        </button>
      </div>
    </form>
  </div>
</mat-card>
